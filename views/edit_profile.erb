<div class="row justify-content-center gutter-sm">
  <div class="col-6" id="profile" data-children=".card-accordion-item">
    <div class="card card-accordion-item">
      <div class="card-header">
        <a href="#identity" data-parent="#profile" data-toggle="collapse">
          <div class="row">
            <div class="col">Identity</div>
            <div class="col-auto">
              <i class="fa fa-chevron-down" aria-hidden="true"></i>
            </div>
          </div>
        </a>
      </div>
      <div id="identity" class="card-body collapse show" role="tabpanel">
        <form id="identity-form" action="javascript:void(0)" method="post" onsubmit="saveIdentity(); return false;">
          <div class="form-group row gutter-sm">
            <div class="col">
              <label>First name</label>
              <input name="firstname" type="text" class="form-control form-control-sm" value="<%= @user.profile[:identity][:firstname] %>" required>
            </div>
            <div class="col">
              <label>Last name</label>
              <input name="lastname" type="text" class="form-control form-control-sm" value="<%= @user.profile[:identity][:lastname] %>" required>
            </div>
          </div>
          <div class="form-group">
            <label>Gender</label>
            <select name="gender" class="form-control form-control-sm" required>
              <option value="none" <%= 'selected' if @user.profile[:identity][:gender] == 'none' %>>Better don't ask</option>
              <option value="male" <%= 'selected' if @user.profile[:identity][:gender] == 'male' %>>Male</option>
              <option value="female" <%= 'selected' if @user.profile[:identity][:gender] == 'female' %>>Female</option>
            </select>
          </div>
          <div class="text-right">
            <a href="#" class="btn btn-neutral btn-sm">Cancel</a>&nbsp;
            <button class="btn btn-primary btn-sm">Save</button>
          </div>
        </form>
      </div>
    </div>
    <br>
    <div class="card card-accordion-item">
      <div class="card-header">
        <a href="#about" data-parent="#profile" data-toggle="collapse">
          <div class="row">
            <div class="col">About me</div>
            <div class="col-auto">
              <i class="fa fa-chevron-down" aria-hidden="true"></i>
            </div>
          </div>
        </a>
      </div>
      <div id="about" class="card-body collapse" role="tabpanel">
        <form id="about-form" action="javascript:void(0)" method="post" onsubmit="saveAbout(); return false;">
          <div class="form-group"></div>
          <div class="text-right">
            <a href="#" class="btn btn-neutral btn-sm">Cancel</a>
            <button class="btn btn-primary btn-sm">Save</button>
          </div>
        </form>
      </div>
    </div>
    <br>
    <div class="card card-accordion-item">
      <div class="card-header">
        <a href="#privacy" data-parent="#profile" data-toggle="collapse">
          <div class="row">
            <div class="col">Privacy</div>
            <div class="col-auto">
              <i class="fa fa-chevron-down" aria-hidden="true"></i>
            </div>
          </div>
        </a>
      </div>
      <div id="privacy" class="card-body collapse" role="tabpanel">
        <form id="privacy-form" action="javascript:void(0)" method="post" onsubmit="savePrivacy(); return false;">
          <div class="form-group"></div>
          <div class="text-right">
            <a href="#" class="btn btn-neutral btn-sm">Cancel</a>
            <button class="btn btn-primary btn-sm">Save</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<script>
  function saveIdentity() {
    var form = document.getElementById('identity-form')
    $.post('/profile/identity', {
      firstname: form.firstname.value,
      lastname: form.lastname.value,
      gender: form.gender.value
    }, function (data) {
      data = JSON.parse(data)
      if(data.success === 0) {

      }
    })
  }

  function saveAbout() {
    var form = document.getElementById('about-form')
    $.post('/profile/about', {

    }, function (data) {
      data = JSON.parse(data)
    })
  }

  function savePrivacy() {
    var form = document.getElementById('privacy-form')
    $.post('/profile/privacy', {

    }, function (data) {
      data = JSON.parse(data)
    })
  }
</script>